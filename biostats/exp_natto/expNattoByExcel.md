# Excel でなぞる遺伝子発現解析（納豆菌編）

普通はプログラミングかR言語でするような遺伝子発現解析を、Excelで試しに（できる部分だけ）やってみようという試み

## 今回利用するデータ
- GSE109523 ：Transcriptome analysis of Bacillus subtilis NBRC 16449 grown on surface of boiled soybeans under the similar condition to production of Japanese traditional soybean-fermented food "natto" https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE109523
- 日本語訳：*Bacillus subtilis*（枯草菌・こそうきん）NBRC 16449株における日本の伝統的な大豆発酵食品 納豆の生産と同条件下における茹でた大豆の表面での成長時のトランスクリプトーム（全遺伝子発現）解析
- 今回はこれを加工したデータを用いる ([Bsubtilis_exp.for_lec.0613.txt](https://raw.githubusercontent.com/chalkless/lecture/master/biostats/exp_natto/Bsubtilis_exp.for_lec.0613.txt))。あらかじめダウンロードしておく。（右クリックして「名前をつけて保存」）
### 生物学的背景
- 生物の遺伝情報はDNAに記録されていて（＝コードされている）、必要な時に必要な遺伝子を使うしくみになっている
- たとえば、今回の枯草菌では4.12Mb（mega base。megaは100万。baseは塩基対。ようするに412万塩基対）のDNAを持っていて、およそ4500の遺伝子を持っている（出展元：[NCBI Genome](https://www.ncbi.nlm.nih.gov/genome/?term=txid86029[Organism:noexp])）
- 「必要な時に必要な遺伝子を使うしくみになっている」とは、たとえば植物なら、葉になるときは光合成のための遺伝子発現が必要だが、根だと光合成の遺伝子発現は不要（なので不要ならmRNAが転写されない、ということ）。今回は微生物だが、たとえば、アミノ酸が周りに豊富にあれば、わざわざアミノ酸を生合成するための酵素は発現しなくてよいが、飢餓状態なら発現が必要、ということ。
- 今回は、液体培地と寒天培地とゆでた大豆の表面という3つの状態だが（ここではそのうち2つの状態について扱うが）これらの状態はどういう遺伝子変化をもたらすだろうか???

### 今回の対象となる生物について
- いわゆる納豆菌のデータ。学名は *Bacillus subtilis subsp. natto*。（subsp. = subspecies。亜種）。種扱いにして Bacillus nattoという名前になっていたり、変種扱いにしてBacillus subtilis var. natto という名前になっている時もある。*Bacillus subtilis*自体は枯草菌（枯草菌）と呼ばれている。生物学でよく使われる（よく出てくる生物ABCDEのB。← 学名の頭文字をとっている） → 参考：[NCBI Taxonomyの当該ページ](https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id=86029&lvl=3&lin=f&keep=1&srchmode=1&unlock)
- NBRCはBiological Resource Center, NITE (National Institute of Technology and Evaluation) （日本語名：（独）製品評価技術基盤機構 バイオテクノロジーセンター）のこと。経産省系の独法であるNITE（ナイト）では企業等のもっている有用微生物を寄託・譲渡してもらい、（半永久的に）保存するとともに、他の企業等に提供して産業に役立てている。
- 今回の納豆菌もNBRCのコレクションとしてストックしてある。
- NBRC 16449とは、菌株番号のこと。コレクション機関名 + 固有番号 といった形式になっている。
- NBRCとして保有している菌株は[DBRP](https://www.nite.go.jp/nbrc/dbrp/top) (Data and Biological Resource Platform) から取得できる。
- たとえば菌株番号で検索すると[Bacillus subtilis NBRC 16449の株情報](https://www.nite.go.jp/nbrc/dbrp/dataview?dataId=STNB0000000016449) が取得できる。生育温度や分離源、培地などの情報が得られる。

### [補足] データを得る実験と公共データベースでの登録
- 今回のデータは元データを加工して解析できるようにしているが、その「元データの加工」の部分をこのセクションは書いている（ので、ここGitHubにアップされているデータを使う分にはここの操作はしなくてよい）
- 今回は、すぐにExcelで開けるように加工済のデータになっているが、元々の配布されているデータは別形式（＋実験データだけでなく実験条件の情報付き）なのでそのままでは使えない。
- （ある生体物質）「全部で」という実験をオミックス（omics）実験と言う。今回は転写産物（transcript）＋全部でtranscriptome実験（もしくは発現解析）というように呼ぶ
- ゲノム（genome。全遺伝子、というか全DNA配列）やトランスクリプトーム解析には次世代シーケンサー（Next-generation Sequencing: NGS）を用いる。
- NGS実験の結果はSequence Read Archive (SRA) というデータベースに集められている。今回は1実験あたり100bpのDNA断片（Read）が1800万本 ×2のデータが収録されている。
- これをジグソーパズルしてつなげることで、遺伝子とその発現量（何コピー分。どのくらい使われているか）に統計処理した発現データはGEO (Gene Expression Omnibus) というデータベースに入っている。
- そして、これらの一連の実験はBioProjectというデータベースからたどれるようになっている。
- 今回の一連の実験はこちら
  - Transcriptome analysis of Bacillus subtilis NBRC 16449 grown on surface of boiled soybeans under the similar condition to production of Japanese traditional soybean-fermented food "natto" https://ddbj.nig.ac.jp/search/entry/bioproject/PRJNA431298
- [参考] NGSリードデータから発現値に直すところ：[遺伝子発現解析（納豆菌編）のためのNGS解析](https://github.com/chalkless/lecture/blob/master/biostats/exp_natto/ngsNatto.md)
- 今回のデータは、実験した登録者が解析してGEOに登録したデータを加工して用いている。
- （わかる人向けの参考の中の参考情報）発現値（どのくらい遺伝子がタンパク質にするために読まれているか）がA_RPKM、B_RPKM、C_RPKMに書かれている。今回は、これをliquid, bean, agarと書き換えている。また、ここでは1回しか実験していないのだが、適当に（正規分布で乱数を発生させて）平均が元々の値になるように2つの実験のようにみせかけたデータを作成した。

## 解析の目標
- 納豆菌の培養条件の違い（今回は液体培地とゆで大豆の表面）でどんな機能の遺伝子が特異的に（=その状態のみで）働いているか?（または働いていないか?）を解析する。

## 遺伝子発現データの統計的な解析
### ファイルを開く
- いきなりつまずく人が多発する鬼門ポイントです。。。
- Excelを立ち上げる
- 補足：大量データを扱う時は、えてしてカンマ区切りファイル（CSV：Comma separated value）かタブ区切りファイル（TSV：TAB separated value）を用います。データの区切りが,（カンマ）かタブ（特殊なスペース）かの違いです
- 今回はタブ区切り（tsv: tab separated value）なので、テキストファイル（Windowsでいうところのメモ帳で開くファイル。Excel形式でないもの）として読み込む
  - [参考] メモ帳的なもので開いた時
![メモ帳的なもので開いた時](./images/Bsubtilis_data_view.png)
  - Windowsの場合：
    - シートの上にファイルをドラッグ&ドロップすると開くようです。開かない例として、ダウンロードすると「最近使ったファイルリスト」のようなところにファイルがリストされる場合があるようです。その場合はファイルを右クリックして、「保存されているフォルダを開く」のようなものを一度はさんで再度 表示し直すとドラッグできるようになります。
    - もしくは、ファイル > 開く で、ファイルの形式をExcel形式でなくタブ区切りファイル（もしくはテキストファイル）を選択するとファイルのリストに表示される（or 選択できるようになる）
  - Macの場合：ファイル > インポート から（拡張子が.txtや.tsvでない場合は、これらに変更しないといけないかもしれない）
    - どの形式か問うダイアログ
    ![どの形式か問うダイアログ](./images/excel_import.png)
  - Excel Online （クラウド版Excel）の場合：なぜかインポート機能がないので、あらかじめデスクトップ版ExcelやGoogle Spreadsheetで開いてExcel形式で保存し、それを開く。→ 今回はExcel版もここにアップしてある（[Bsubtilis_exp.for_lec.0614.xlsx](https://github.com/chalkless/lecture/raw/master/biostats/exp_natto/Bsubtilis_exp.for_lec.0614.xlsx)）
- 読み込みのダイアログが出た場合：区切り記号付き → 区切り文字 タブ などと選びながら次へを押していく
  - ![](https://github.com/chalkless/lecture/blob/master/biostats/exp_natto/images/excel_import_dialogue1.png)
  - ![](https://github.com/chalkless/lecture/blob/master/biostats/exp_natto/images/excel_import_dialogue2.png) 
  - 各列のデータタイプで遺伝子名が書かれた列は標準でなく文字列を選ぶとOct4問題は回避できる
  - ![](https://github.com/chalkless/lecture/blob/master/biostats/exp_natto/images/excel_import_dialogue3.png)
  - Oct4問題：Excelのおせっかいで、遺伝子名Oct4が、勝手に日付だと解釈されてしまう問題。実際の値が、2020/10/4などとその年の10月4日になってしまうので、早い話が遺伝子名が消されてしまう。OctXやSepXの遺伝子で起きる。
- 無事に開ける
- **[ファイルの保存]** 何はともあれファイルの保存。ファイル > **名前をつけて保存** で Excelブックとして保存
  - - ![Excel形式での保存](./images/save.png)
  - 普通に（テキストファイルとして）保存してしまうと、関数やグラフが保存されないので**Excelブック（.xlsx）の形式で保存しなおす**。 
- 今回はFeature_ID、Protein_ID、Product、liquid_1、liquid_2、bean_1、bean_2、agar_1、agar_2 というデータ構成になっている。
- 全部で4,272行（うち先頭はタイトル行）。画面の分割をすると楽である。
  - 表示タブ > 分割
    ![](https://github.com/chalkless/lecture/blob/master/biostats/exp_natto/images/excel_split.png)
  - 線をドラッグすると分割場所を動かせる。端まで持って行くと分割解除
  - 下半分のウインドウのどこかのセルを選択し、スクロールバーをドラッグして末尾へ。

### 各実験の値が比較可能かを確認する
- まずシートをコピーして元のデータをうっかり書き換えないようにする
- データの列には実験ごとに遺伝子の発現量が数値で入っている
- ちらちら眺めると0に近い値から千まで数値があるような
#### 各実験の代表的な統計値で実験値が比較可能か確認する
- そこで、各列の一番下の行で最大値と最小値を計算して実験ごとの値の比較をしてみる
  - 一番下のデータの次の行あたりでセルを選択して
  - fxから入力するなり、手入力するなり。手入力の場合、途中まで入れると候補が出るので↑/↓で選んでTABを押すと範囲指定までいける
  - 最大値を例に：`=max(`まで入力すると、範囲を聞かれるので、上ウインドウでD2（一番上）をクリックし、下ウインドウでD4272をShiftを押しながらクリック。Enterを押すと`)`が勝手に補完されて計算される。
  - 同様に最小値 `=min(...)`も
- 続けて、中央値（median）と平均値も計算してみる
- 1列分計算できたので、計算結果を複数セル選択し、右下をドラッグして数式をコピーする
- 結果が出る
  - ![最大値、最小値、中央値、平均値の結果](./images/excel_function.png)
- 考察：左2列がliquid（液体培地）、真ん中2列がbean（ゆで大豆の表面）、右2つがagar（寒天培地）。これからその2列どうしの数値の平均をとるが、特に中央値や平均値が大きくずれていないので、2列のデータの分布はほぼ同じそうだと期待でき、特に補正（正規化という）をせずに先に進むこととする。（すでに補正済のデータが登録されていたのかもしれない）
#### 各実験でのデータの分布を可視化して直接的に比較する
##### 各データのヒストグラム
- ヒストグラム（度数分布）は横軸にデータの値の範囲を（たとえば0.1ごととか、たとえば全体の範囲を20分割するとかして）、縦軸にその範囲に入るデータの個数を表示したグラフで、どの範囲にデータが集まっているか、を可視化するものです。
- 各データが取る範囲はヒストグラムで確認できる。描画したいデータの範囲（例：D2..D4272）をドラッグして挿入タブ → グラフのところの「統計」→ ヒストグラム
- しかし、グラフが幅広い割に0に近いところにほとんどのデータがあってよくわからない
  - ![](./images/excel_histogram_tmp.png)
- そこで各値の対数を取る。
  - なぜ対数?
    - 桁数のブレが大きい時に桁数を圧縮できる
    - 対数にすると統計モデルにフィットする場合が多々ある
  - J1にラベルをつける：例：log(liquid_1)
  - J2で：log関数を用いる。`=log(`と入力すると引数のヘルプがポップアップで出てくる。`=log(値,底)`。今回は`=log(D2,2)`となる。（底は2とする）
  - J2をコピーして、J3〜J4272にコピーする。J3をクリックして、J4272をShiftを押しながらクリックしてペースト。
- 改めてJ2..J4272でヒストグラムを描いてみる。割ときれいな山の形になる
  - ![](./images/Bsubtilis_histogram.png)
- （補足）場合によってはデータはそのままでグラフを描く時に軸を対数にする片対数グラフ/両対数グラフというやり方もできます。
- 同様にliquid_2とbean_1も対数を取ってみる
- log(liquid_2)のヒストグラムも描いてみて形が似ていることを確認する。（山頂部分の麓部分の数字）
##### 散布図での2つのデータの比較
- 散布図（scatter plot）は2つの実験条件を縦軸・横軸にとって、値を打っていくグラフです。2つの実験条件での値の散らばりを直接的に確認できます
  - 今回は、液体どうし、豆の表面どうしは似ているが液体と豆の表面だとグラフが散っていることを確認します。また後で出てきます。
- 各遺伝子ごとに横軸と縦軸で2つの実験データを描画する散布図を描いてみる
- 液体の2実験での散布図
  - J1（log_liquid1のラベル）をクリック
  - Shiftを押しながらK4272（log(liquid_2)の最後のデータ）をクリックする
  - 挿入タブ → 散布図
- 液体と豆の表面での散布図
  - 同様にJ1クリック → L4272をShift+クリックして散布図を描く：この場合は横軸がlog(liquid_1)で、縦軸がlog(liquid_2)とlog(bean_1)の両方が描画されるが、簡単のためにこのままにする。
  - ![](./images/Bsubtilis_scatter_compare.png)
- 2回の実験で、特にliquid_1とliquid_2は同じ条件で実験しているはずなので理想的には値も同じはず。つまりy=xのグラフに載るのが理想。
- liquid_1とbean_1は遺伝子の使われ方が違うので少し値がぶれている（グラフが広がっている）ことを確認する
- せっかくなので、どのくらい値が似ているかを相関係数で示してみる。
  - 相関係数は−1〜1をとる数字。0だと相関なし。1に近いほど（正の）相関が高い。−1に近いほど負の相関（逆相関）
  - Googleで調べると`=correl(範囲1,範囲2)`で調べるらしい
  - log(liquid_2)の一番下（K4272）ででも：`=correl(`と入れる → log(liquid_1)の指定：J2をクリックしてJ4272をShift+クリック → ,を入力 → log(liquid_2)の指定：K2をクリックしてK4272をShift+クリック
  - 同様にL4273（log(bean_1)の一番下）ででもlog(liquid_1)とlog(bean_1)の相関係数を調べる
  - 結果
    - log(liquid_1) vs　log(liquid_2)= 0.977625526
    - log(liquid_1) vs　log(bean_1)  = 0.837418738

### 各遺伝子で2つの状態での発現量を比較する
- ここでもシートをコピーして元のデータをうっかり書き換えないようにする
#### 2回の実験の平均をとる
- 左2列のliquid、真ん中2列のbeanをそれぞれ2回実験をしたとみなして、誤差を補正するために平均をとることとする。一般的には3回以上の実験（通称 n=3。nとは実験回数のこと）が望ましいとされている。
- **これは各遺伝子で2回の実験の平均をとる作業**：先ほどは各実験の統計だったので列方向（縦）に平均をとった。今回は各遺伝子で実験値がどうかなので行方向（横）に平均をとる。
- agarのH列、I列はとりあえず使わないので列名を右クリックして非表示
- 今回なら、空白列であるJ1にでも liquid なり適当にラベルを振っておく
- とりあえず一番上のデータである2行目でliquid1とliquid2の2データの平均をとる（隣接するセルでないとエラーが出るが無視するを選択すればよい）
  - D2からE2の範囲指定：J2セルで`=average(` とうって、D2セルをクリック。その後、コンマを入力してE2を選択するか、shiftを押しながらE2をクリックか、でEnter
- 全データで平均値をとる。今 計算したセル（J2）を選択してコピー。ペーストしたいセルとしてまずはJ3をクリック。shiftキーを押しながら下ウインドウのJ4272をクリックしてペースト。計算結果が出ればOK
- 同様にbeanも各データの平均値を計算する
#### 各発現値の対数をとる
- 発現量データの対数をとる。この場合は今 計算した平均値に対して対数を計算する。
  - 上の方で最大値、最小値を計算した際にわかるように、ケタが4桁近く違うので、数値を扱いやすくするのだと思ってくれ
  - （とはいえ、このあと2状態の発現「比」を計算するので、その時点でだいぶケタの範囲が小さくなる気もするが）
  - あとは、対数をとると発現の分布が正規分布（イメージ：左右対称のきれいなグラフ）になるので、モデル化しやすくする、という効果も狙っている（あとで可視化して確認する）
- 平均を計算した右列に対数を計算する列を挿入する。今回はL列、M列
- 一番上に、log(liquid) などと適当にラベルをつけておく
- 対数を計算する。`=log(`とうつと`=log([数値],[底])`と関数の書式を教えてくれるので、数値として平均値のJ2をクリック、カンマを打って、底として2を入力する
  - 別に底は2でも10でもいいのだが、マイクロアレイなどの発現解析の時は、伝統的に「発現比2倍以上」というデータの絞り込みをしていたため、わかりやすくするために底は2を用いている。（というか、そういうこともわかりやすくするために対数をとるのである）
- 同様に下まで関数をコピーする。のち、beanの方も対数の計算をしておく。
#### データの分布を確認する
- 実際のデータで分布がどうなっているかも散布図 (scatter plot) で確認することとする
- 2つのlog列を選択して、挿入タブ > 散布図 > 散布図
  - ![散布図ボタン](../exp/images/excel_scatter_alias.png)
- 散布図 (scatter plot) が描画される
  - ![散布図](./images/excel_scatter.png)
- この後、発現比を計算してから考察します。
#### 発現比の計算
- **覚えていますか**：[解析の目標] 納豆菌の培養条件の違い（今回は液体培地とゆで大豆の表面）でどんな機能の遺伝子が特異的に（=その状態のみで）働いているか?（または働いていないか?）を解析する。
- そのために、液体と豆の表面での値の比を計算する
  - 最初にデータの分布を見た時に（maxとかaverageとか計算していたあのへん）、値が数千、数万のものと0.1や15など0に近いものとあったので、差が同じ1でも数千に対する1と数十に対する1では影響が大違い
  - → 差でなくて比をとる
- （対数を計算したけれども）平均の`liquid`と`bean`で比を取る
- N列にラベルをつける；`diff`
- 液体を基準に、豆の表面の実験値が何倍になったか、何分の1になったか：N2で`=K2/J2`（K2やJ2はセルをクリックしてもいい）
  - 参考：実際の実験では、片方の値が0になることがある。0で割る演算はできないので、その場合は`=(K2+0.01)/(J2+0.01)`のように分子分母に0に近い数字を足して比を取る。（なのでさっきminを計算した）
- N3〜N4272まで値をコピーする
- diff列の値を見ると、値はほぼほぼ1に近い。液体や前の表面など培養条件が変わっても大半の遺伝子の量は特に影響されないということがわかる（散布図も参照）
- 実際に確認：試しに diff 列について、`max`, `min`, `average`, `median` を計算してみる
  - 特にaverage、medianはほぼ1（1倍）のはず。（というか、元の分布がそうなるようにすでに補正してあるわけである）。ちょとずれてるけどｗ
- 発現比も対数を取る
  - 試しにヒストグラムを描いてみると1のあたりだけに棒が立つグラフになってしまう。
  - これも桁数の圧縮のために対数を取る、と思ってくれれば。
  - O1（Oはアルファベットのオー）にラベルをつける：log(diff)
  - O2に計算式：`=log(N2,2)`
  - O3〜O4272に数式をコピー
  - 参考：さっき液体と豆の表面の平均値で対数をとったけど? 
      - 覚えていますか：log(A/B) = log(A) - log(B)
      - なので、それを使うなら、`=M2-L2`：つまり、`log(bean)-log(liquid)`。対数ごとの比を取ってはダメです

### 発現量比較のデータを眺めてみる
- diff 列のデータの意味を振り返ってみる
  - `diff = 2` ：2倍の発現差がある。この場合、beanの発現が高い
  - `diff = 0.5`：1/2倍の発現差がある。この場合、beanの発現が1/2だから、liquidの方が2倍発現が高い
  - `diff = 1`：liquidもbeanも発現は同じ
- 同じことをlog(diff)で解釈すると
  - `log(diff) = 1` ：2^1=2で2倍の発現差がある。この場合、beanの発現が高い
  - `log(diff) = -1`：2^-1=1/2 だから1/2倍の発現差がある。この場合、beanの発現が1/2だから、liquidの方が2倍発現が高い
  - `log(diff) = 0`：つまり、2^0=1。ようするに、beanとliquidで発現量が同じということ
- 実際のデータの分布がどんなかヒストグラムを描いて確認してみる
- log(diff) 列のデータ部分を選択して、挿入タブ > （グラフの中の）統計 を選ぶ
  - ![統計ボタン](../exp/images/excel_hist_alias.png)
- ヒストグラムを選択すると、グラフが描画される
  - ![ヒストグラム](./images/excel_histogram.png)
  - 0 を中心に左右対称になっている
  - （もう少し横幅を狭めたいのだが、Excelでできるのかどうか調べてできたら追記することとする）
- 散布図 (scatter plot) でも眺めてみる
  - ![散布図](./images/excel_scatter.png)
  - y=x 、つまり、log(bean)=log(liquid)の線が心の目で見えるが、これはようするに発現が変動していない遺伝子はこの上に載りますということ。
  - その線から離れるほど、発現が変わっている
  - 下に離れるとliquidで発現が大きい、上に離れるとbeanで大きい

## 発現に差のある遺伝子の機能解析
- **覚えていますか**：[解析の目標] 納豆菌の培養条件の違い（今回は液体培地とゆで大豆の表面）でどんな機能の遺伝子が特異的に（=その状態のみで）働いているか?（または働いていないか?）を解析する。

### 発現に差のあるデータの絞り込み
- beanで発現の高い遺伝子のみを抽出してみる。今回は試しに8倍以上にしてみる
  - 8 という数字は適当です。
  - 適当というのは、まぁ、こんなもんかな、ってことです。
  - どうしてまぁ、こんなもんかなって思うかは、試しに絞り込んでみて、（全体が数千くらいに対して）いくつくらいに絞り込めるかとか、結果を見てみたらきれいになったとか、信頼度がどのくらいかとか、そういうので決めているだけで、統計的にかっちり基準があるわけではありません。
  - またあとでこのあたりは出てきます
- とりあえず、フィルターするとデータの個数が何個になるか気になるのでその用意をすることとする。
- 関数名がわからないので「Excel フィルター 個数」などとググる
- と、どうやら`=subtotal(3,範囲名)`と書けばいいらしい
  - 3 は`counta`関数と同じく、空白でないセルの個数を返すという呪文らしい
- diffで絞り込むのでdiffの列にでも移動して`=subtotal(3,N2:N4272)`と書いておく（範囲指定は手打ちしなくてもこれまでやっている選択→shift+選択でまったくかまわない）
  - 4271と出れば成功
- ここからやっと絞り込み
- diffラベルのセルを選択して（別にどこでもいいのだが）ホームタブ > 並べ替えとフィルター > フィルター。すると、ラベル行の各セルに▼がつく
- diffラベルのセルで▼をクリックすると、どうフィルターするか出てくるので、「1つ選択してください」から「指定の値以上」で 8 と指定する
- としばらくExcelが考え、下半分のウインドウが真っ白なシートを表示するので、おちついてスクロールバーをドラッグして表示していあるところまで上にスクロール
- 何個 表示されているか確認
  - 209個かー。ちょっと多いなー。もう少し絞り込むかー
  - というわけで、16倍（対数で4）くらいにしてみる
  - diffラベルの▼は電波の弱いガラケーアンテナのような形になっているが、再びそれをクリックし、3以上を4以上にする
  - 112個になった。
  - 今回はこのくらいで許してやろう
  - 結果的に対数で4（実データで16倍）になったが、「このくらいで」というのは人間が見れるくらいの数くらいのイメージ。別に3でも5でも10でもよい。また別基準で上位50件、上位100件としてもよい（ただだいたい何倍くらいになっているかは確認した方がいい気はする）。

### 遺伝子機能解析
- 遺伝子発現に差があった遺伝子は生物学的にどういう意味があるのかを確認する
- ここから遺伝子機能解析を専門のサイトでやります。（本当はExcelでやりたいのだが）
- DAVIDでググる。
  - ただ、あまりに一般的な名前なので、geneもくっつけて検索する。
  - と、DAVID Functional Annotation Bioinformatics Microarray Analysis というサイトが出てくる（はず）。クリックしてそのサイトに行く
  - https://davidbioinformatics.nih.gov/
  - DAVIDは（遺伝子機能による）エンリッチメント解析ということをやるサイトです。ランダムに選んだ遺伝子セットに対して、この遺伝子セットは顕著にこの機能が多いですね、みたいなものを可視化してくれます。
    - エンリッチメント＝濃縮 みたいな意味。ランダムに選んだ（偶然に任せて）遺伝子セットよりも、今回の遺伝子セットはこの機能の遺伝子が集まっていますね、と言う意味で濃縮です。
- タイトル下の Start Analysis をクリック
- 画面が切り替わり、左カラムに入力ボックスが現れる
- Excelに戻って、IDをコピーする
  - B列のProtein_IDを使う
  - データのない"-"はノイズになってしまうので、▼をクリックして -　の横のチェックを外す
  - ここで、１列だけ（多分、この場合はdiffの列でしょう）▼やケータイのアンテナマークがある場合は、１列だけ選択してフィルターをかけてしまっています。一度、フィルターを外して、適当なデータのところをクリックし、再度フィルターをかけると全部の列にフィルターがつくはずです。
  - B列で（見た目で）2行目から一番下まで（max とか # of dataはいらない）をコピーする
  - DAVIDのPaste a listにペースト
-　Step 2で”UNIPROT_ACCESSION”を選ぶ
- ペーストした下の方の Step 3 でGene Listを選ぶ
- Step 4でSubmit Listをポチる
- 真ん中上にAnalysis Wizard、左カラムでBacillus subtilisなどと出れば成功
  - 返ってこないときは、ご相談ください（とりあえずbean/liquidでbeanで増えるものは動くのは確認した）
- Functional Annotation Toolをクリック
- 機能解析メニューが出てくる
- よく使うのは Gene Ontology
  - Ontologyというのは階層型の用語集（キーワード集）
    - 階層型というのは 人体 > 泌尿器系 > 腎臓 > 糸球体 のようなこと
- 解析：GOTERM_BP_ALL の右のChartをクリック
  - BPは biological process。生物学的な挙動（そのままw）
  - teichoic acidやcell wall （細胞壁）の単語がチラホラ
  - もともとの2群の違いは細胞壁があるかないか
  - いいじゃないか
-　本当はGO_CC（Cellular Component：細胞のパーツ）やGO_MF（Molecular Function）でもいろいろ出てほしいのだが...

## まとめと発展
- Excelで統計の手法で遺伝子を絞り込み、機能解析をしてみた
- よくR言語での〜というのがあるが、Excelでもこのくらいならできる
  - 昔は256列までしか扱えなかったので、しんどかった時代もある
- 今回は、beanで発現の高い遺伝子について解析したが、もちろんliquidで発現の高い遺伝子についても同様の解析をやってみたりする。
- さらに、今回は発現の高い遺伝子「セット」で解析をしたが、そこに含まれる実際の遺伝子は何か、というのをマイクロアレイのプローブIDから遺伝子名に直して眺めたりするわけである。
  - GEOのサイトにあるSOFT formatted family file(s)には対応表が載っているので、あらかじめそれをExcelででも列追加して解析を始めるか、あとで個別に眺めるかするわけである
- さらに今回は、液体培地と茹でた大豆の表面いう2群だったが、他の例だと「通常と薬剤処理の細胞」、「通常期と繁殖期の魚」、「淡水型と海水型の魚」、「春型と夏型のチョウ」、「タバコを吸う人と吸わない人」などなどの前提条件と、条件の違いで遺伝子発現がどう変化するかというような研究が考えられるわけだ。
- **生物統計というと、ついついどんな統計手法で、と統計の方に目がいってしまうが、生物学のゴールは統計処理でなくて、そこで得られた遺伝子セットを生物学的に解釈する（そして最初の実験条件と照らし合わせる）、というところなのをお忘れなく。**
